<!DOCTYPE html>
<html>
<head>
    <title>QuizMakerAi - Creador de Cuestionarios</title>
    <style>
        :root {
            --negro: #0f0f1a;
            --azul: #3b82f6;
            --azul-hover: #2563eb;
            --gris: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background: var(--negro);
            color: var(--gris);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logo {
            font-size: 2rem;
            color: var(--azul);
            margin-bottom: 0.5rem;
        }

        /* Modos de Uso */
        .modo-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .modo-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            cursor: pointer;
            transition: 0.3s;
        }

        .modo-card:hover {
            border-color: var(--azul);
            transform: translateY(-2px);
        }

        /* Formularios */
        .formulario {
            background: rgba(255, 255, 255, 0.05);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        input[type="text"], 
        textarea {
            width: 100%;
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: var(--gris);
            border-radius: 6px;
        }

        button {
            background: var(--azul);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
        }

        button:hover {
            background: var(--azul-hover);
        }

        /* Preview */
        .preview {
            background: rgba(255, 255, 255, 0.05);
            padding: 2rem;
            border-radius: 8px;
        }

        .quiz-item {
            margin: 1rem 0;
            padding: 1.5rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
        }

        .loading {
            text-align: center;
            color: var(--azul);
            padding: 2rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .modo-selector {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">ðŸ“š QuizMakerAi</div>
            <p>Genera cuestionarios con IA o manualmente</p>
        </header>

        <div class="modo-selector">
            <div class="modo-card" onclick="mostrarModo('ia')">
                <h3>Modo IA</h3>
                <p>Genera quizzes automÃ¡ticamente</p>
            </div>
            <div class="modo-card" onclick="mostrarModo('manual')">
                <h3>Modo Manual</h3>
                <p>Crea quizzes personalizados</p>
            </div>
        </div>

        <!-- Modo IA -->
        <div id="modo-ia" class="formulario" style="display: none;">
            <h3>Generar con IA</h3>
            <textarea id="texto-ia" rows="5" placeholder="Pega aquÃ­ el texto para generar el quiz..."></textarea>
            <input type="file" id="documento" accept=".pdf,.docx,.txt" style="margin: 1rem 0;">
            <button onclick="generarQuizIA()">Generar Quiz con IA</button>
            <div id="ia-loading" class="loading" style="display: none;">Generando quiz...</div>
        </div>

        <!-- Modo Manual -->
        <div id="modo-manual" class="formulario" style="display: none;">
            <h3>Crear Manualmente</h3>
            <input type="text" id="pregunta" placeholder="Escribe la pregunta...">
            <div id="opciones-container">
                <input type="text" class="opcion" placeholder="OpciÃ³n 1">
                <input type="text" class="opcion" placeholder="OpciÃ³n 2">
            </div>
            <button onclick="agregarOpcion()" style="margin: 1rem 0;">+ AÃ±adir OpciÃ³n</button>
            <input type="text" id="respuesta-correcta" placeholder="Respuesta correcta (ej: OpciÃ³n 1)">
            <button onclick="agregarPregunta()">Guardar Pregunta</button>
        </div>

        <!-- Preview -->
        <div class="preview">
            <h3>Preview del Quiz</h3>
            <div id="quiz-preview"></div>
            <button id="tomar-quiz" onclick="iniciarQuiz()" style="margin-top: 1rem; display: none;">Tomar Quiz</button>
        </div>
    </div>

    <script>
        let preguntas = [];
        let quizActual = 0;
        let puntaje = 0;

        // Mostrar modo seleccionado
        function mostrarModo(modo) {
            document.getElementById('modo-ia').style.display = 
                modo === 'ia' ? 'block' : 'none';
            document.getElementById('modo-manual').style.display = 
                modo === 'manual' ? 'block' : 'none';
        }

        // IntegraciÃ³n con Poe AI
        async function generarQuizIA() {
            const texto = document.getElementById('texto-ia').value;
            const loading = document.getElementById('ia-loading');
            
            if(!texto) {
                alert('Por favor ingresa un texto para generar el quiz');
                return;
            }

            try {
                loading.style.display = 'block';
                
                // API call a Poe
                const response = await fetch('https://poe.com/QuizMakerAI', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'tfVql_G7vDF961RKQxkWSfeOnXULyppOyWUTGnuB6lg'
                    },
                    body: JSON.stringify({
                        query: `Genera un quiz con 5 preguntas basadas en este texto: ${texto}. 
                                Formato JSON: 
                                [{"pregunta": "...", "opciones": ["...", "..."], "respuesta": "..."}]`
                    })
                });

                const data = await response.json();
                
                if(data && data.length) {
                    preguntas = data;
                    renderizarPreview();
                    document.getElementById('tomar-quiz').style.display = 'block';
                }
            } catch(error) {
                console.error('Error:', error);
                alert('Error al generar el quiz. Verifica la API key y el chatbot');
            } finally {
                loading.style.display = 'none';
            }
        }

        // Funciones de modo manual
        function agregarOpcion() {
            const container = document.getElementById('opciones-container');
            const newInput = document.createElement('input');
            newInput.type = 'text';
            newInput.className = 'opcion';
            newInput.placeholder = `OpciÃ³n ${container.children.length + 1}`;
            container.appendChild(newInput);
        }

        function agregarPregunta() {
            const pregunta = document.getElementById('pregunta').value;
            const opciones = Array.from(document.getElementsByClassName('opcion'))
                                  .map(op => op.value);
            const respuesta = document.getElementById('respuesta-correcta').value;
            
            if(pregunta && opciones.length >= 2 && respuesta) {
                preguntas.push({ pregunta, opciones, respuesta });
                renderizarPreview();
                document.getElementById('tomar-quiz').style.display = 'block';
                // Limpiar formulario
                document.getElementById('pregunta').value = '';
                document.querySelectorAll('.opcion').forEach(op => op.value = '');
                document.getElementById('respuesta-correcta').value = '';
            }
        }

        // Renderizar preview
        function renderizarPreview() {
            const preview = document.getElementById('quiz-preview');
            preview.innerHTML = preguntas.map((q, i) => `
                <div class="quiz-item">
                    <h4>Pregunta ${i+1}: ${q.pregunta}</h4>
                    <ul>
                        ${q.opciones.map(op => `<li>â€¢ ${op}</li>`).join('')}
                    </ul>
                    <p><strong>Respuesta correcta:</strong> ${q.respuesta}</p>
                </div>
            `).join('');
        }

        // Sistema de quiz interactivo
        function iniciarQuiz() {
            quizActual = 0;
            puntaje = 0;
            mostrarPregunta();
        }

        function mostrarPregunta() {
            if(quizActual >= preguntas.length) {
                alert(`Quiz completado! PuntuaciÃ³n: ${puntaje}/${preguntas.length}`);
                return;
            }

            const pregunta = preguntas[quizActual];
            const preview = document.getElementById('quiz-preview');
            
            preview.innerHTML = `
                <div class="quiz-item">
                    <h3>Pregunta ${quizActual+1}/${preguntas.length}</h3>
                    <h4>${pregunta.pregunta}</h4>
                    <div style="margin: 1rem 0;">
                        ${pregunta.opciones.map((op, idx) => `
                            <div style="margin: 0.5rem 0;">
                                <button onclick="verificarRespuesta(${idx})" 
                                        style="width: 100%; text-align: left; padding: 1rem;">
                                    ${op}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function verificarRespuesta(opcionElegida) {
            const respuestaCorrecta = preguntas[quizActual].respuesta;
            const opciones = preguntas[quizActual].opciones;
            
            if(opciones[opcionElegida] === respuestaCorrecta) {
                puntaje++;
                alert('Â¡Correcto! ðŸŽ‰');
            } else {
                alert(`Incorrecto. La respuesta era: ${respuestaCorrecta}`);
            }
            
            quizActual++;
            mostrarPregunta();
        }
    </script>
</body>
</html>